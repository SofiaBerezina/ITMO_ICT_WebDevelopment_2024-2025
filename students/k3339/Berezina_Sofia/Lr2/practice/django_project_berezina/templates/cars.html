<!DOCTYPE html>
<html>
<head>
    <title>–í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</title>
    {% load static %}
    <link href="{% static 'project_first_app/css/style.css' %}" rel="stylesheet">
</head>
<body>
    <div class="nav-links">
        <a href="{% url 'owners' %}" class="btns">–í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã</a>
        <a href="{% url 'cars' %}" class="btns">–í—Å–µ –∞–≤—Ç–æ–º–æ–±–∏–ª–∏</a>
        <a href="{% url 'car_create' %}" class="btn-add">–î–æ–±–∞–≤–∏—Ç—å –∞–≤—Ç–æ–º–æ–±–∏–ª—å</a>
    </div>

    <h1>–°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–≤—Ç–æ–º–æ–±–∏–ª–µ–π</h1>

    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>–ù–æ–º–µ—Ä</th>
                <th>–ú–∞—Ä–∫–∞</th>
                <th>–ú–æ–¥–µ–ª—å</th>
                <th>–¶–≤–µ—Ç</th>
                <th>–¢–µ–∫—É—â–∏–π –≤–ª–∞–¥–µ–ª–µ—Ü</th>
                <th>–í—Å–µ –≤–ª–∞–¥–µ–ª—å—Ü—ã</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for car in cars %}
            <tr>
                <td>{{ car.car_id }}</td>
                <td>{{ car.number }}</td>
                <td>{{ car.brand }}</td>
                <td>{{ car.model }}</td>
                <td>{{ car.color }}</td>
                <td>
                    {% with current_owner=car.get_current_owner %}
                        {% if current_owner %}
                            <strong>üëë {{ current_owner.first_name }} {{ current_owner.last_name }}</strong>
                        {% else %}
                            <span style="color: #999;">–ù–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–∞</span>
                        {% endif %}
                    {% endwith %}
                </td>
                <td>
                    {% for ownership in car.get_all_owners %}
                        <div style="margin-bottom: 5px;">
                            {% if ownership.is_current %}
                                üëë <strong>{{ ownership.owner.first_name }} {{ ownership.owner.last_name }}</strong>
                                <br><small>—Å {{ ownership.start_date }} (—Ç–µ–∫—É—â–∏–π)</small>
                            {% else %}
                                üë§ {{ ownership.owner.first_name }} {{ ownership.owner.last_name }}
                                <br><small>{{ ownership.start_date }} - {{ ownership.end_date }}</small>
                            {% endif %}
                        </div>
                    {% empty %}
                        <span style="color: #999;">–ù–µ—Ç –≤–ª–∞–¥–µ–ª—å—Ü–µ–≤</span>
                    {% endfor %}
                </td>
                <td class="action-links">
                    <a href="{% url 'car' car.car_id %}" class="btn-view">–ü–æ–¥—Ä–æ–±–Ω–µ–µ</a>
                    <br>
                    <a href="{% url 'car_form' car.car_id %}" class="btn-edit">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                    <br>
                    <a href="{% url 'car_delete' car.car_id %}" class="btn-delete">–£–¥–∞–ª–∏—Ç—å</a>
                </td>
            </tr>
            {% empty %}
            <tr>
                <td colspan="8">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –æ–± –∞–≤—Ç–æ–º–æ–±–∏–ª—è—Ö</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>