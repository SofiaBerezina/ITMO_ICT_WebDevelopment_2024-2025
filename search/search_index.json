{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\u0412\u0430\u0440\u0438\u0430\u043d\u0442 \u2116 4: \u0421\u043f\u0438\u0441\u043e\u043a \u0442\u0443\u0440\u043e\u0432 \u0442\u0443\u0440\u0438\u0441\u0442\u0438\u0447\u0435\u0441\u043a\u043e\u0439 \u0444\u0438\u0440\u043c\u044b","text":"<p><code>\u0417\u0430\u0434\u0430\u043d\u0438\u0435</code>: \u0425\u0440\u0430\u043d\u0438\u0442\u0441\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0438 \u0442\u0443\u0440\u0430, \u0442\u0443\u0440\u0430\u0433\u0435\u043d\u0441\u0442\u0432\u0435, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0438 \u0442\u0443\u0440\u0430, \u043f\u0435\u0440\u0438\u043e\u0434\u0435 \u043f\u0440\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u044f \u0442\u0443\u0440\u0430, \u0443\u0441\u043b\u043e\u0432\u0438\u044f\u0445 \u043e\u043f\u043b\u0430\u0442\u044b.</p> <p>\u041d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u043e \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u0442\u044c \u0441\u043b\u0435\u0434\u0443\u044e\u0449\u0438\u0439 \u0444\u0443\u043d\u043a\u0446\u0438\u043e\u043d\u0430\u043b:</p> <ul> <li>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043d\u043e\u0432\u044b\u0445 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u0439.</li> <li>\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440 \u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u043e\u0432. \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0438 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u044f \u0441\u0432\u043e\u0438\u0445 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439.</li> <li>\u041d\u0430\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043a \u0442\u0443\u0440\u0430\u043c. \u041f\u0440\u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0438 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0435\u0432, \u0434\u043e\u043b\u0436\u043d\u044b \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0442\u044c\u0441\u044f \u0434\u0430\u0442\u044b \u0442\u0443\u0440\u0430, \u0442\u0435\u043a\u0441\u0442 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u044f, \u0440\u0435\u0439\u0442\u0438\u043d\u0433 (1-10), \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u044f \u043e \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0442\u043e\u0440\u0435.</li> <li>\u0410\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440 \u0434\u043e\u043b\u0436\u0435\u043d \u0438\u043c\u0435\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 \u0441\u0440\u0435\u0434\u0441\u0442\u0432\u0430\u043c\u0438 Django-admin.</li> <li>\u0412 \u043a\u043b\u0438\u0435\u043d\u0442\u0441\u043a\u043e\u0439 \u0447\u0430\u0441\u0442\u0438 \u0434\u043e\u043b\u0436\u043d\u0430 \u0444\u043e\u0440\u043c\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f \u0442\u0430\u0431\u043b\u0438\u0446\u0430, \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0430\u044e\u0449\u0430\u044f \u0432\u0441\u0435 \u043f\u0440\u043e\u0434\u0430\u043d\u043d\u044b\u0435 \u0442\u0443\u0440\u044b \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c.</li> </ul>"},{"location":"#1","title":"1. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043f\u0440\u043e\u0435\u043a\u0442\u0430 \u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430:","text":"<p>\u0421\u043d\u0430\u0447\u0430\u043b\u0430 \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0435 \u043e\u043a\u0440\u0443\u0436\u0435\u043d\u0438\u0435 \u0434\u043b\u044f \u0438\u0437\u043e\u043b\u044f\u0446\u0438\u0438 \u0437\u0430\u0432\u0438\u0441\u0438\u043c\u043e\u0441\u0442\u0435\u0439 \u043f\u0440\u043e\u0435\u043a\u0442\u0430. \u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0442\u0435\u0440\u043c\u0438\u043d\u0430\u043b \u0438 \u0432\u044b\u043f\u043e\u043b\u043d\u044f\u0435\u043c:</p> <pre><code>python -m venv venv\nsource venv/bin/activate\npip install django\n\ndjango-admin startproject tourfirm\n\npython manage.py startapp tour_app\n</code></pre> <p>\u041e\u0442\u043a\u0440\u044b\u0432\u0430\u0435\u043c \u0444\u0430\u0439\u043b tourfirm/settings.py \u0438 \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430\u0448\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435 \u0432 \u0441\u043f\u0438\u0441\u043e\u043a INSTALLED_APPS:</p> <pre><code>INSTALLED_APPS = [\n    'django.contrib.admin',\n    'django.contrib.auth',\n    'django.contrib.contenttypes',\n    'django.contrib.sessions',\n    'django.contrib.messages',\n    'django.contrib.staticfiles',\n    'tour_app',  # \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430\u0448\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435\n]\n</code></pre>"},{"location":"#2-modelspy","title":"2. \u0421\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432 \u0444\u0430\u0439\u043b\u0435 <code>models.py</code>","text":"<p>\u0424\u0430\u0439\u043b <code>models.py</code> \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u0435\u0442 \u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u0443 \u0431\u0430\u0437\u044b \u0434\u0430\u043d\u043d\u044b\u0445. \u041a\u0430\u0436\u0434\u044b\u0439 \u043a\u043b\u0430\u0441\u0441 \u043c\u043e\u0434\u0435\u043b\u0438 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0442\u0430\u0431\u043b\u0438\u0446\u0435 \u0432 \u0411\u0414, \u0430 \u0430\u0442\u0440\u0438\u0431\u0443\u0442\u044b \u043a\u043b\u0430\u0441\u0441\u0430 - \u0441\u0442\u043e\u043b\u0431\u0446\u0430\u043c \u0442\u0430\u0431\u043b\u0438\u0446\u044b.</p> <p>\u041e\u0431\u044a\u044f\u0441\u043d\u0435\u043d\u0438\u0435 \u0440\u0435\u0430\u043b\u0438\u0437\u043e\u0432\u0430\u043d\u043d\u044b\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439:</p> <ul> <li><code>Tour</code>: \u041c\u043e\u0434\u0435\u043b\u044c \u0434\u043b\u044f \u0445\u0440\u0430\u043d\u0435\u043d\u0438\u044f \u0438\u043d\u0444\u043e\u0440\u043c\u0430\u0446\u0438\u0438 \u043e \u0442\u0443\u0440\u0430\u0445 (\u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435, \u0430\u0433\u0435\u043d\u0442\u0441\u0442\u0432\u043e, \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435, \u0441\u0442\u0440\u0430\u043d\u0430, \u0434\u0430\u0442\u044b, \u0446\u0435\u043d\u0430)</li> <li><code>Reservation</code>: \u041c\u043e\u0434\u0435\u043b\u044c \u0434\u043b\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u0442\u0443\u0440\u043e\u0432 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f\u043c\u0438 \u0441 \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u043c\u0438 \u0441\u0442\u0430\u0442\u0443\u0441\u0430\u043c\u0438</li> <li><code>Review</code>: \u041c\u043e\u0434\u0435\u043b\u044c \u0434\u043b\u044f \u043e\u0442\u0437\u044b\u0432\u043e\u0432 \u043e \u0442\u0443\u0440\u0430\u0445 \u0441 \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u043e\u043c \u043e\u0442 1 \u0434\u043e 10</li> </ul>"},{"location":"#tour","title":"<code>\u041c\u043e\u0434\u0435\u043b\u044c Tour (\u0422\u0443\u0440)</code>","text":"<pre><code>class Tour(models.Model):\n    title = models.CharField(max_length=200, verbose_name=\"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430\")\n    agency = models.CharField(max_length=200, verbose_name=\"\u0422\u0443\u0440\u0430\u0433\u0435\u043d\u0441\u0442\u0432\u043e\")\n    description = models.TextField(verbose_name=\"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430\")\n    country = models.CharField(max_length=100, verbose_name=\"\u0421\u0442\u0440\u0430\u043d\u0430\")\n    start_date = models.DateField(verbose_name=\"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430\")\n    end_date = models.DateField(verbose_name=\"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f\")\n    payment_conditions = models.TextField(verbose_name=\"\u0423\u0441\u043b\u043e\u0432\u0438\u044f \u043e\u043f\u043b\u0430\u0442\u044b\")\n    price = models.DecimalField(max_digits=10, decimal_places=2, verbose_name=\"\u0426\u0435\u043d\u0430\")\n    created_at = models.DateTimeField(auto_now_add=True)\n\n    class Meta:\n        verbose_name = \"\u0422\u0443\u0440\"\n        verbose_name_plural = \"\u0422\u0443\u0440\u044b\"\n        ordering = ['start_date']\n\n    def __str__(self):\n        return f\"{self.title} - {self.agency}\"\n</code></pre> <p>\u0410\u0442\u0440\u0438\u0431\u0443\u0442\u044b:</p> <ul> <li><code>title</code> - \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 (CharField, \u043c\u0430\u043a\u0441. 200 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432)</li> <li><code>agency</code> - \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430\u0433\u0435\u043d\u0441\u0442\u0432\u0430 (CharField)</li> <li><code>description</code> - \u043f\u043e\u0434\u0440\u043e\u0431\u043d\u043e\u0435 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0442\u0443\u0440\u0430 (TextField \u0434\u043b\u044f \u0434\u043b\u0438\u043d\u043d\u043e\u0433\u043e \u0442\u0435\u043a\u0441\u0442\u0430)</li> <li><code>country</code> - \u0441\u0442\u0440\u0430\u043d\u0430 \u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f (CharField)</li> <li><code>start_date</code>, <code>end_date</code> - \u0434\u0430\u0442\u044b \u043d\u0430\u0447\u0430\u043b\u0430 \u0438 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0442\u0443\u0440\u0430 (DateField)</li> <li><code>payment_conditions</code> - \u0443\u0441\u043b\u043e\u0432\u0438\u044f \u043e\u043f\u043b\u0430\u0442\u044b (TextField)</li> <li><code>price</code> - \u0446\u0435\u043d\u0430 \u0442\u0443\u0440\u0430 (DecimalField \u0434\u043b\u044f \u0442\u043e\u0447\u043d\u044b\u0445 \u0434\u0435\u043d\u0435\u0436\u043d\u044b\u0445 \u0440\u0430\u0441\u0447\u0435\u0442\u043e\u0432)</li> <li><code>created_at</code> - \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0434\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u0437\u0430\u043f\u0438\u0441\u0438 (auto_now_add=True)</li> </ul> <p><code>Meta</code> \u043a\u043b\u0430\u0441\u0441:</p> <ul> <li><code>verbose_name</code> - \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u043e\u0447\u0438\u0442\u0430\u0435\u043c\u043e\u0435 \u0438\u043c\u044f \u0432 \u0435\u0434\u0438\u043d\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u043c \u0447\u0438\u0441\u043b\u0435 \u0434\u043b\u044f \u0430\u0434\u043c\u0438\u043d\u043a\u0438</li> <li><code>verbose_name_plural</code> - \u0438\u043c\u044f \u0432\u043e \u043c\u043d\u043e\u0436\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e\u043c \u0447\u0438\u0441\u043b\u0435</li> <li><code>ordering</code> - \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0434\u0430\u0442\u0435 \u043d\u0430\u0447\u0430\u043b\u0430 \u0442\u0443\u0440\u0430</li> </ul> <p>\u041c\u0435\u0442\u043e\u0434 <code>str</code>: \u0412\u043e\u0437\u0432\u0440\u0430\u0449\u0430\u0435\u0442 \u0441\u0442\u0440\u043e\u043a\u043e\u0432\u043e\u0435 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u0430 \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0433\u043e \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0432 \u0430\u0434\u043c\u0438\u043d\u043a\u0435 \u0438 \u0448\u0430\u0431\u043b\u043e\u043d\u0430\u0445.</p>"},{"location":"#reservation","title":"<code>\u041c\u043e\u0434\u0435\u043b\u044c Reservation (\u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435)</code>","text":"<pre><code>class Reservation(models.Model):\n    STATUS_CHOICES = [\n        ('pending', '\u041e\u0436\u0438\u0434\u0430\u0435\u0442 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f'),\n        ('confirmed', '\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d'),\n        ('cancelled', '\u041e\u0442\u043c\u0435\u043d\u0435\u043d'),\n    ]\n\n    user = models.ForeignKey(User, on_delete=models.CASCADE, verbose_name=\"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\")\n    tour = models.ForeignKey(Tour, on_delete=models.CASCADE, verbose_name=\"\u0422\u0443\u0440\")\n    reservation_date = models.DateTimeField(auto_now_add=True, verbose_name=\"\u0414\u0430\u0442\u0430 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\")\n    status = models.CharField(max_length=20, choices=STATUS_CHOICES, default='pending', verbose_name=\"\u0421\u0442\u0430\u0442\u0443\u0441\")\n    notes = models.TextField(blank=True, verbose_name=\"\u041f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f\")\n\n    class Meta:\n        verbose_name = \"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\"\n        verbose_name_plural = \"\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\"\n        unique_together = ['user', 'tour']\n\n    def __str__(self):\n        return f\"{self.user.username} - {self.tour.title}\"\n</code></pre> <ul> <li><code>STATUS_CHOICES</code> - \u0441\u043f\u0438\u0441\u043e\u043a \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0445 \u0441\u0442\u0430\u0442\u0443\u0441\u043e\u0432 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0441 \u0447\u0435\u043b\u043e\u0432\u0435\u043a\u043e\u0447\u0438\u0442\u0430\u0435\u043c\u044b\u043c\u0438 \u043d\u0430\u0437\u0432\u0430\u043d\u0438\u044f\u043c\u0438</li> <li><code>user</code> - \u0441\u0432\u044f\u0437\u044c \u0441 \u043c\u043e\u0434\u0435\u043b\u044c\u044e User (ForeignKey), \u043a\u0430\u0441\u043a\u0430\u0434\u043d\u043e\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u0438\u0435</li> <li><code>tour</code> - \u0441\u0432\u044f\u0437\u044c \u0441 \u043c\u043e\u0434\u0435\u043b\u044c\u044e Tour (ForeignKey)</li> <li><code>reservation_date</code> - \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0434\u0430\u0442\u0430 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f</li> <li><code>status</code> - \u0441\u0442\u0430\u0442\u0443\u0441 \u0431\u0440\u043e\u043d\u0438 \u0441 \u0432\u044b\u0431\u043e\u0440\u043e\u043c \u0438\u0437 \u043f\u0440\u0435\u0434\u043e\u043f\u0440\u0435\u0434\u0435\u043b\u0435\u043d\u043d\u044b\u0445 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u0439</li> <li><code>notes</code> - \u043f\u0440\u0438\u043c\u0435\u0447\u0430\u043d\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f (\u043c\u043e\u0436\u0435\u0442 \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c)</li> <li><code>unique_together</code>: \u0413\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u043e\u0434\u0438\u043d \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043d\u0435 \u043c\u043e\u0436\u0435\u0442 \u0437\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043e\u0434\u0438\u043d \u0442\u0443\u0440 multiple \u0440\u0430\u0437.</li> </ul>"},{"location":"#review","title":"<code>\u041c\u043e\u0434\u0435\u043b\u044c Review (\u041e\u0442\u0437\u044b\u0432)</code>","text":"<pre><code>class Review(models.Model):\n    user = models.ForeignKey(User, on_delete=models.CASCADE, verbose_name=\"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\")\n    tour = models.ForeignKey(Tour, on_delete=models.CASCADE, verbose_name=\"\u0422\u0443\u0440\")\n    text = models.TextField(verbose_name=\"\u0422\u0435\u043a\u0441\u0442 \u043e\u0442\u0437\u044b\u0432\u0430\")\n    rating = models.IntegerField(\n        validators=[MinValueValidator(1), MaxValueValidator(10)],\n        verbose_name=\"\u0420\u0435\u0439\u0442\u0438\u043d\u0433\"\n    )\n    created_at = models.DateTimeField(auto_now_add=True, verbose_name=\"\u0414\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f\")\n    tour_start_date = models.DateField(verbose_name=\"\u0414\u0430\u0442\u0430 \u043d\u0430\u0447\u0430\u043b\u0430 \u0442\u0443\u0440\u0430\")\n    tour_end_date = models.DateField(verbose_name=\"\u0414\u0430\u0442\u0430 \u043e\u043a\u043e\u043d\u0447\u0430\u043d\u0438\u044f \u0442\u0443\u0440\u0430\")\n\n    class Meta:\n        verbose_name = \"\u041e\u0442\u0437\u044b\u0432\"\n        verbose_name_plural = \"\u041e\u0442\u0437\u044b\u0432\u044b\"\n        unique_together = ['user', 'tour']\n\n    def __str__(self):\n        return f\"{self.user.username} - {self.tour.title} - {self.rating}/10\"\n</code></pre> <ul> <li><code>user</code>, <code>tour</code> - \u0441\u0432\u044f\u0437\u0438 \u0441 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u0435\u043c \u0438 \u0442\u0443\u0440\u043e\u043c</li> <li><code>text</code> - \u0442\u0435\u043a\u0441\u0442 \u043e\u0442\u0437\u044b\u0432\u0430</li> <li><code>rating</code> - \u0440\u0435\u0439\u0442\u0438\u043d\u0433 \u043e\u0442 1 \u0434\u043e 10 \u0441 \u0432\u0430\u043b\u0438\u0434\u0430\u0442\u043e\u0440\u0430\u043c\u0438 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0438 \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u0433\u043e \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f</li> <li><code>created_at</code> - \u0434\u0430\u0442\u0430 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u044f \u043e\u0442\u0437\u044b\u0432\u0430</li> <li><code>tour_start_date</code>, <code>tour_end_date</code> - \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0434\u0430\u0442\u044b \u043f\u043e\u0435\u0437\u0434\u043a\u0438 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</li> </ul> <p>ordering: \u0421\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043e\u0442 \u043d\u043e\u0432\u044b\u0445 \u043a \u0441\u0442\u0430\u0440\u044b\u043c \u043e\u0442\u0437\u044b\u0432\u0430\u043c</p> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0430\u0439\u043b\u044b \u043c\u0438\u0433\u0440\u0430\u0446\u0438\u0439 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 \u043d\u0430\u0448\u0438\u0445 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u044f\u0435\u043c \u0438\u0445 \u043a \u0431\u0430\u0437\u0435 \u0434\u0430\u043d\u043d\u044b\u0445:</p> <pre><code>python manage.py makemigrations\npython manage.py migrate\n</code></pre>"},{"location":"#3-adminpy","title":"3. \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u0430\u0434\u043c\u0438\u043d-\u043f\u0430\u043d\u0435\u043b\u0438 \u0432 <code>admin.py</code>","text":"<p>\u0424\u0430\u0439\u043b admin.py \u043d\u0430\u0441\u0442\u0440\u0430\u0438\u0432\u0430\u0435\u0442 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u0435 \u0438 \u043f\u043e\u0432\u0435\u0434\u0435\u043d\u0438\u0435 \u043c\u043e\u0434\u0435\u043b\u0435\u0439 \u0432 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043d\u0435\u043b\u0438 Django.</p> <p>\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u0443\u0435\u043c \u043d\u0430\u0448\u0438 \u043c\u043e\u0434\u0435\u043b\u0438 \u0432 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u0438\u0432\u043d\u043e\u0439 \u043f\u0430\u043d\u0435\u043b\u0438 Django \u0434\u043b\u044f \u0443\u0434\u043e\u0431\u043d\u043e\u0433\u043e \u0443\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0434\u0430\u043d\u043d\u044b\u043c\u0438:</p>"},{"location":"#-tour","title":"<code>\u0410\u0434\u043c\u0438\u043d-\u043a\u043b\u0430\u0441\u0441 \u0434\u043b\u044f Tour</code>","text":"<pre><code>@admin.register(Tour)\nclass TourAdmin(admin.ModelAdmin):\n    list_display = ['title', 'agency', 'country', 'start_date', 'end_date', 'price']\n    list_filter = ['agency', 'country', 'start_date']\n    search_fields = ['title', 'description']\n</code></pre> <ul> <li><code>list_display</code> - \u043a\u0430\u043a\u0438\u0435 \u043f\u043e\u043b\u044f \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0442\u044c \u0432 \u0441\u043f\u0438\u0441\u043a\u0435 \u043e\u0431\u044a\u0435\u043a\u0442\u043e\u0432</li> <li><code>list_filter</code> - \u043f\u043e \u043a\u0430\u043a\u0438\u043c \u043f\u043e\u043b\u044f\u043c \u043c\u043e\u0436\u043d\u043e \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u043f\u0438\u0441\u043e\u043a</li> <li><code>search_fields</code> - \u043f\u043e \u043a\u0430\u043a\u0438\u043c \u043f\u043e\u043b\u044f\u043c \u043e\u0441\u0443\u0449\u0435\u0441\u0442\u0432\u043b\u044f\u0435\u0442\u0441\u044f \u043f\u043e\u0438\u0441\u043a</li> </ul>"},{"location":"#-reservation","title":"<code>\u0410\u0434\u043c\u0438\u043d-\u043a\u043b\u0430\u0441\u0441 \u0434\u043b\u044f Reservation</code>","text":"<pre><code>@admin.register(Reservation)\nclass ReservationAdmin(admin.ModelAdmin):\n    list_display = ['user', 'tour', 'reservation_date', 'status']\n    list_filter = ['status', 'reservation_date']\n    search_fields = ['user__username', 'tour__title']\n    list_editable = ['status']\n    actions = ['confirm_reservations']\n\n    def confirm_reservations(self, request, queryset):\n        queryset.update(status='confirmed')\n        self.message_user(request, f'{queryset.count()} \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043e')\n    confirm_reservations.short_description = \"\u041f\u043e\u0434\u0442\u0432\u0435\u0440\u0434\u0438\u0442\u044c \u0432\u044b\u0431\u0440\u0430\u043d\u043d\u044b\u0435 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\"\n</code></pre> <ul> <li><code>list_editable</code> - \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0441\u0442\u0430\u0442\u0443\u0441 \u043f\u0440\u044f\u043c\u043e \u0438\u0437 \u0441\u043f\u0438\u0441\u043a\u0430</li> <li><code>actions</code> - \u043a\u0430\u0441\u0442\u043e\u043c\u043d\u044b\u0435 \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u044f \u0434\u043b\u044f \u043c\u0430\u0441\u0441\u043e\u0432\u043e\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0435\u043d\u0438\u044f</li> <li><code>confirm_reservations</code> - \u043c\u0435\u0442\u043e\u0434 \u0434\u043b\u044f \u043c\u0430\u0441\u0441\u043e\u0432\u043e\u0433\u043e \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u0438\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439</li> </ul>"},{"location":"#-review","title":"<code>\u0410\u0434\u043c\u0438\u043d-\u043a\u043b\u0430\u0441\u0441 \u0434\u043b\u044f Review</code>","text":"<pre><code>@admin.register(Review)\nclass ReviewAdmin(admin.ModelAdmin):\n    list_display = ['user', 'tour', 'rating', 'created_at']\n    list_filter = ['rating', 'created_at']\n    search_fields = ['user__username', 'tour__title', 'text']\n</code></pre> <p>\u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0430\u0442\u043e\u0440\u0430\u043c \u043f\u0440\u043e\u0441\u043c\u0430\u0442\u0440\u0438\u0432\u0430\u0442\u044c \u0438 \u0443\u043f\u0440\u0430\u0432\u043b\u044f\u0442\u044c \u043e\u0442\u0437\u044b\u0432\u0430\u043c\u0438, \u0444\u0438\u043b\u044c\u0442\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u043e \u0440\u0435\u0439\u0442\u0438\u043d\u0433\u0443 \u0438 \u0434\u0430\u0442\u0435.</p>"},{"location":"#3-viewspy","title":"3. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u0435\u043d\u0438\u044f \u0432 <code>views.py</code> \u0434\u043b\u044f \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432 \u0438 \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446:","text":"<p>\u0424\u0430\u0439\u043b <code>views.py</code> \u0441\u043e\u0434\u0435\u0440\u0436\u0438\u0442 \u0432\u0441\u044e \u0431\u0438\u0437\u043d\u0435\u0441-\u043b\u043e\u0433\u0438\u043a\u0443 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f - \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0443 \u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432, \u0440\u0430\u0431\u043e\u0442\u0443 \u0441 \u0434\u0430\u043d\u043d\u044b\u043c\u0438, \u0440\u0435\u043d\u0434\u0435\u0440\u0438\u043d\u0433 \u0448\u0430\u0431\u043b\u043e\u043d\u043e\u0432.</p>"},{"location":"#home-","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u044f home - \u0413\u043b\u0430\u0432\u043d\u0430\u044f \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0430</code>","text":"<pre><code>def home(request):\n    tours = Tour.objects.all()\n    return render(request, 'home.html', {'tours': tours})\n</code></pre> <p>\u041f\u043e\u043b\u0443\u0447\u0430\u0435\u0442 \u0432\u0441\u0435 \u0442\u0443\u0440\u044b \u0438\u0437 \u0411\u0414 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0435\u0442 \u0438\u0445 \u0432 \u0448\u0430\u0431\u043b\u043e\u043d \u0434\u043b\u044f \u043e\u0442\u043e\u0431\u0440\u0430\u0436\u0435\u043d\u0438\u044f.</p>"},{"location":"#register-","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u044f register - \u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f</code>","text":"<pre><code>def register(request):\n    if request.method == 'POST':\n        form = UserRegistrationForm(request.POST)\n        if form.is_valid():\n            user = form.save()\n            login(request, user)\n            messages.success(request, '\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f \u043f\u0440\u043e\u0448\u043b\u0430 \u0443\u0441\u043f\u0435\u0448\u043d\u043e!')\n            return redirect('home')\n    else:\n        form = UserRegistrationForm()\n    return render(request, 'register.html', {'form': form})\n</code></pre> <p>\u041b\u043e\u0433\u0438\u043a\u0430 \u0440\u0430\u0431\u043e\u0442\u044b:</p> <ul> <li>\u0415\u0441\u043b\u0438 POST-\u0437\u0430\u043f\u0440\u043e\u0441 - \u043e\u0431\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u0435\u043c \u0434\u0430\u043d\u043d\u044b\u0435 \u0444\u043e\u0440\u043c\u044b</li> <li>\u0415\u0441\u043b\u0438 \u0444\u043e\u0440\u043c\u0430 \u0432\u0430\u043b\u0438\u0434\u043d\u0430 - \u0441\u043e\u0445\u0440\u0430\u043d\u044f\u0435\u043c \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f, \u043b\u043e\u0433\u0438\u043d\u0438\u043c \u0435\u0433\u043e \u0438 \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435</li> <li>\u0415\u0441\u043b\u0438 GET-\u0437\u0430\u043f\u0440\u043e\u0441 - \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u043c \u043f\u0443\u0441\u0442\u0443\u044e \u0444\u043e\u0440\u043c\u0443</li> </ul>"},{"location":"#custom_logout-","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u044f custom_logout - \u0412\u044b\u0445\u043e\u0434 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b</code>","text":"<pre><code>@csrf_protect\ndef custom_logout(request):\n    if request.method == 'POST':\n        logout(request)\n        messages.success(request, '\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0432\u044b\u0448\u043b\u0438 \u0438\u0437 \u0441\u0438\u0441\u0442\u0435\u043c\u044b.')\n        return redirect('login')\n    else:\n        # \u0415\u0441\u043b\u0438 \u043a\u0442\u043e-\u0442\u043e \u043f\u043e\u043f\u044b\u0442\u0430\u0435\u0442\u0441\u044f \u0432\u044b\u0439\u0442\u0438 \u0447\u0435\u0440\u0435\u0437 GET, \u043f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u044f\u0435\u043c \u043d\u0430 \u0433\u043b\u0430\u0432\u043d\u0443\u044e\n        return redirect('home')\n</code></pre> <ul> <li>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 @csrf_protect \u0434\u043b\u044f \u0437\u0430\u0449\u0438\u0442\u044b \u043e\u0442 CSRF-\u0430\u0442\u0430\u043a</li> <li>\u041f\u0440\u0438\u043d\u0438\u043c\u0430\u0435\u0442 \u0442\u043e\u043b\u044c\u043a\u043e POST-\u0437\u0430\u043f\u0440\u043e\u0441\u044b \u0434\u043b\u044f \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u043e\u0441\u0442\u0438</li> <li>\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0441\u043e\u043e\u0431\u0449\u0435\u043d\u0438\u0435 \u043e\u0431 \u0443\u0441\u043f\u0435\u0448\u043d\u043e\u043c \u0432\u044b\u0445\u043e\u0434\u0435</li> </ul>"},{"location":"#tour_detail-","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u044f tour_detail - \u0414\u0435\u0442\u0430\u043b\u0438 \u0442\u0443\u0440\u0430</code>","text":"<pre><code>@login_required\ndef tour_detail(request, tour_id):\n    tour = get_object_or_404(Tour, id=tour_id)\n    user_reservation = None\n    user_review = None\n\n    if request.user.is_authenticated:\n        user_reservation = Reservation.objects.filter(user=request.user, tour=tour).first()\n        user_review = Review.objects.filter(user=request.user, tour=tour).first()\n\n    reviews = Review.objects.filter(tour=tour).exclude(user=request.user)\n\n    if request.method == 'POST':\n        if 'reserve' in request.POST:\n            reservation_form = ReservationForm(request.POST)\n            if reservation_form.is_valid() and not user_reservation:\n                reservation = reservation_form.save(commit=False)\n                reservation.user = request.user\n                reservation.tour = tour\n                reservation.save()\n                messages.success(request, '\u0422\u0443\u0440 \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d!')\n                return redirect('tour_detail', tour_id=tour_id)\n\n        elif 'review' in request.POST:\n            review_form = ReviewForm(request.POST)\n            if review_form.is_valid():\n                if user_review:\n                    review_form = ReviewForm(request.POST, instance=user_review)\n                    review = review_form.save()\n                    messages.success(request, '\u041e\u0442\u0437\u044b\u0432 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d!')\n                else:\n                    review = review_form.save(commit=False)\n                    review.user = request.user\n                    review.tour = tour\n                    review.save()\n                    messages.success(request, '\u041e\u0442\u0437\u044b\u0432 \u0434\u043e\u0431\u0430\u0432\u043b\u0435\u043d!')\n                return redirect('tour_detail', tour_id=tour_id)\n    else:\n        reservation_form = ReservationForm(instance=user_reservation)\n        review_form = ReviewForm(instance=user_review)\n\n    return render(request, 'tour_detail.html', {\n        'tour': tour,\n        'reservation_form': reservation_form,\n        'review_form': review_form,\n        'user_reservation': user_reservation,\n        'user_review': user_review,\n        'reviews': reviews,\n    })\n</code></pre> <p>\u041b\u043e\u0433\u0438\u043a\u0430 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0438:</p> <ol> <li> <p>\u041f\u043e\u043b\u0443\u0447\u0435\u043d\u0438\u0435 \u0434\u0430\u043d\u043d\u044b\u0445:</p> </li> <li> <p>\u0422\u0443\u0440 \u043f\u043e ID (\u0441 \u043e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 404 \u043e\u0448\u0438\u0431\u043a\u0438)</p> </li> <li>\u0411\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u0442\u0437\u044b\u0432 \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0434\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u0442\u0443\u0440\u0430</li> <li> <p>\u0412\u0441\u0435 \u043e\u0442\u0437\u044b\u0432\u044b \u043e \u0442\u0443\u0440\u0435</p> </li> <li> <p>\u041e\u0431\u0440\u0430\u0431\u043e\u0442\u043a\u0430 POST-\u0437\u0430\u043f\u0440\u043e\u0441\u043e\u0432:</p> </li> <li> <p>\u0420\u0430\u0437\u0434\u0435\u043b\u0435\u043d\u0438\u0435 \u043d\u0430 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0438 \u043e\u0442\u0437\u044b\u0432 \u043f\u043e \u0438\u043c\u0435\u043d\u0438 \u043a\u043d\u043e\u043f\u043a\u0438</p> </li> <li>\u0414\u043b\u044f \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f: \u043f\u0440\u043e\u0432\u0435\u0440\u043a\u0430, \u0447\u0442\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u0435\u0449\u0435 \u043d\u0435 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043b \u044d\u0442\u043e\u0442 \u0442\u0443\u0440</li> <li> <p>\u0414\u043b\u044f \u043e\u0442\u0437\u044b\u0432\u0430: \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u044e\u0449\u0435\u0433\u043e \u0438\u043b\u0438 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0435 \u043d\u043e\u0432\u043e\u0433\u043e</p> </li> <li> <p>\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435 commit=False: \u041f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f \u043f\u0435\u0440\u0435\u0434 \u0441\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435\u043c</p> </li> <li>\u041f\u0435\u0440\u0435\u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435: \u041f\u043e\u0441\u043b\u0435 \u0443\u0441\u043f\u0435\u0448\u043d\u044b\u0445 \u043e\u043f\u0435\u0440\u0430\u0446\u0438\u0439 - \u0440\u0435\u0434\u0438\u0440\u0435\u043a\u0442 \u043d\u0430 \u044d\u0442\u0443 \u0436\u0435 \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443 \u0434\u043b\u044f \u043f\u0440\u0435\u0434\u043e\u0442\u0432\u0440\u0430\u0449\u0435\u043d\u0438\u044f \u043f\u043e\u0432\u0442\u043e\u0440\u043d\u043e\u0439 \u043e\u0442\u043f\u0440\u0430\u0432\u043a\u0438 \u0444\u043e\u0440\u043c\u044b</li> </ol>"},{"location":"#my_reservations-","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u044f my_reservations - \u041c\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f</code>","text":"<pre><code>@login_required\ndef my_reservations(request):\n    reservations = Reservation.objects.filter(user=request.user)\n    return render(request, 'my_reservations.html', {'reservations': reservations})\n</code></pre> <p>\u041f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u0435\u0442 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f \u0442\u0435\u043a\u0443\u0449\u0435\u0433\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f.</p>"},{"location":"#edit_reservation-delete_reservation","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u0438 edit_reservation \u0438 delete_reservation</code>","text":"<pre><code>@login_required\ndef edit_reservation(request, reservation_id):\n    reservation = get_object_or_404(Reservation, id=reservation_id, user=request.user)\n\n    if request.method == 'POST':\n        form = ReservationForm(request.POST, instance=reservation)\n        if form.is_valid():\n            form.save()\n            messages.success(request, '\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u043e\u0431\u043d\u043e\u0432\u043b\u0435\u043d\u043e!')\n            return redirect('my_reservations')\n    else:\n        form = ReservationForm(instance=reservation)\n\n    return render(request, 'edit_reservation.html', {'form': form, 'reservation': reservation})\n</code></pre> <pre><code>@login_required\ndef delete_reservation(request, reservation_id):\n    reservation = get_object_or_404(Reservation, id=reservation_id, user=request.user)\n\n    if request.method == 'POST':\n        reservation.delete()\n        messages.success(request, '\u0420\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435 \u0443\u0434\u0430\u043b\u0435\u043d\u043e!')\n        return redirect('my_reservations')\n\n    return render(request, 'delete_reservation.html', {'reservation': reservation})\n</code></pre> <p><code>get_object_or_404(Reservation, id=reservation_id, user=request.user)</code> \u0433\u0430\u0440\u0430\u043d\u0442\u0438\u0440\u0443\u0435\u0442, \u0447\u0442\u043e \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043c\u043e\u0436\u0435\u0442 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c/\u0443\u0434\u0430\u043b\u044f\u0442\u044c \u0442\u043e\u043b\u044c\u043a\u043e \u0441\u0432\u043e\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f.</p>"},{"location":"#sold_tours_by_country-","title":"<code>\u0424\u0443\u043d\u043a\u0446\u0438\u044f sold_tours_by_country - \u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043a\u0430</code>","text":"<pre><code>def sold_tours_by_country(request):\n    # \u0422\u0443\u0440\u044b \u0441 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u043c\u0438 \u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\u043c\u0438\n    sold_tours = Tour.objects.filter(\n        reservation__status='confirmed'\n    ).annotate(\n        reservations_count=Count('reservation'),\n        total_sold=Sum('reservation__tour__price')\n    ).order_by('country')\n\n    return render(request, 'sold_tours.html', {'sold_tours': sold_tours})\n</code></pre> <p>\u0417\u0430\u043f\u0440\u043e\u0441\u044b \u043a \u0411\u0414:</p> <ul> <li><code>filter(reservation__status='confirmed')</code> - \u0442\u043e\u043b\u044c\u043a\u043e \u0442\u0443\u0440\u044b \u0441 \u043f\u043e\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043d\u043d\u044b\u043c\u0438 \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u044f\u043c\u0438</li> <li><code>annotate()</code> - \u0434\u043e\u0431\u0430\u0432\u043b\u044f\u0435\u0442 \u0432\u044b\u0447\u0438\u0441\u043b\u044f\u0435\u043c\u044b\u0435 \u043f\u043e\u043b\u044f:</li> <li><code>reservations_count</code> - \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e \u0431\u0440\u043e\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0439</li> <li><code>total_sold</code> - \u043e\u0431\u0449\u0430\u044f \u0441\u0443\u043c\u043c\u0430 \u043f\u0440\u043e\u0434\u0430\u0436</li> <li> <p><code>order_by('country')</code> - \u0441\u043e\u0440\u0442\u0438\u0440\u043e\u0432\u043a\u0430 \u043f\u043e \u0441\u0442\u0440\u0430\u043d\u0430\u043c</p> </li> <li> <p>\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0430\u0439\u043b <code>urls.py</code> \u0434\u043b\u044f \u043c\u0430\u0440\u0448\u0440\u0443\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0432\u043d\u0443\u0442\u0440\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f:</p> </li> </ul> <pre><code>from django.urls import path\nfrom django.contrib import admin\nfrom django.contrib.auth import views as auth_views\nfrom tour_app import views\n\n\nurlpatterns = [\n    path('', views.home, name='home'),\n    path('admin/', admin.site.urls),\n    path('register/', views.register, name='register'),\n    path('login/', auth_views.LoginView.as_view(template_name='login.html'), name='login'),\n    path('logout/', views.custom_logout, name='logout'),\n    path('tour/&lt;int:tour_id&gt;/', views.tour_detail, name='tour_detail'),\n    path('my-reservations/', views.my_reservations, name='my_reservations'),\n    path('reservation/edit/&lt;int:reservation_id&gt;/', views.edit_reservation, name='edit_reservation'),\n    path('reservation/delete/&lt;int:reservation_id&gt;/', views.delete_reservation, name='delete_reservation'),\n    path('sold-tours/', views.sold_tours_by_country, name='sold_tours'),\n]\n</code></pre>"},{"location":"#3-formspy","title":"3. \u0412 <code>forms.py</code> \u0441\u043e\u0437\u0434\u0430\u0434\u0438\u043c \u0444\u043e\u0440\u043c\u044b \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438 \u0438 \u043b\u043e\u0433\u0438\u043d\u0430","text":"<pre><code>from django import forms\nfrom django.contrib.auth.forms import UserCreationForm\nfrom django.contrib.auth.models import User\nfrom .models import Reservation, Review\n\nclass UserRegistrationForm(UserCreationForm):\n    email = forms.EmailField(required=True)\n\n    class Meta:\n        model = User\n        fields = ['username', 'email', 'password1', 'password2']\n\nclass ReservationForm(forms.ModelForm):\n    class Meta:\n        model = Reservation\n        fields = ['notes']\n        widgets = {\n            'notes': forms.Textarea(attrs={'rows': 3, 'class': 'form-control'}),\n        }\n\nclass ReviewForm(forms.ModelForm):\n    class Meta:\n        model = Review\n        fields = ['text', 'rating', 'tour_start_date', 'tour_end_date']\n        widgets = {\n            'text': forms.Textarea(attrs={'rows': 4, 'class': 'form-control'}),\n            'rating': forms.NumberInput(attrs={'min': 1, 'max': 10, 'class': 'form-control'}),\n            'tour_start_date': forms.DateInput(attrs={'type': 'date', 'class': 'form-control'}),\n            'tour_end_date': forms.DateInput(attrs={'type': 'date', 'class': 'form-control'}),\n        }\n</code></pre>"}]}